Use detection scripts for idempotency. System vs user context appropriately. Log to %ProgramData%\Company\Logs.
